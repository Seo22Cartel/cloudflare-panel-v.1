# ü§ñ Telegram –ë–æ—Ç –¥–ª—è –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –°–µ—Ä–≤–µ—Ä–∞

–°–∏—Å—Ç–µ–º–∞ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ —Å–µ—Ä–≤–µ—Ä–æ–≤ —Å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è–º–∏ –≤ Telegram.

## ‚ú® –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

- ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ URL –ø–æ HTTP/HTTPS
- üì± –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –≤ Telegram –ø—Ä–∏ –ø–∞–¥–µ–Ω–∏–∏
- üü¢ –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–∏ —Ä–∞–±–æ—Ç—ã
- ‚è±Ô∏è –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º—ã–π –∏–Ω—Ç–µ—Ä–≤–∞–ª –ø—Ä–æ–≤–µ—Ä–∫–∏
- üìä –ü–æ—Ä–æ–≥ —Å—Ä–∞–±–∞—Ç—ã–≤–∞–Ω–∏—è (–∏–∑–±–µ–∂–∞–Ω–∏–µ –ª–æ–∂–Ω—ã—Ö —Å—Ä–∞–±–∞—Ç—ã–≤–∞–Ω–∏–π)
- üìù –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö —Å–æ–±—ã—Ç–∏–π
- üîÑ –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö URL
- üë• –û—Ç–ø—Ä–∞–≤–∫–∞ –Ω–µ—Å–∫–æ–ª—å–∫–∏–º –ø–æ–ª—É—á–∞—Ç–µ–ª—è–º

## üì¶ –£—Å—Ç–∞–Ω–æ–≤–∫–∞

### –®–∞–≥ 1: –°–æ–∑–¥–∞–Ω–∏–µ Telegram –±–æ—Ç–∞

1. **–û—Ç–∫—Ä–æ–π—Ç–µ Telegram** –∏ –Ω–∞–π–¥–∏—Ç–µ –±–æ—Ç–∞ `@BotFather`

2. **–°–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤–æ–≥–æ –±–æ—Ç–∞:**
   ```
   /newbot
   ```

3. **–í–≤–µ–¥–∏—Ç–µ –∏–º—è –±–æ—Ç–∞** (–æ—Ç–æ–±—Ä–∞–∂–∞–µ–º–æ–µ –∏–º—è):
   ```
   Server Monitor Bot
   ```

4. **–í–≤–µ–¥–∏—Ç–µ username –±–æ—Ç–∞** (–¥–æ–ª–∂–µ–Ω –∑–∞–∫–∞–Ω—á–∏–≤–∞—Ç—å—Å—è –Ω–∞ `bot`):
   ```
   my_server_monitor_bot
   ```

5. **–°–æ—Ö—Ä–∞–Ω–∏—Ç–µ —Ç–æ–∫–µ–Ω** - BotFather –ø—Ä–∏—à–ª—ë—Ç —á—Ç–æ-—Ç–æ –≤—Ä–æ–¥–µ:
   ```
   7123456789:AAHxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
   ```

### –®–∞–≥ 2: –ü–æ–ª—É—á–µ–Ω–∏–µ Chat ID

**–°–ø–æ—Å–æ–± 1: –ß–µ—Ä–µ–∑ @userinfobot**
1. –ù–∞–π–¥–∏—Ç–µ –≤ Telegram –±–æ—Ç–∞ `@userinfobot`
2. –û—Ç–ø—Ä–∞–≤—å—Ç–µ –µ–º—É –ª—é–±–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
3. –û–Ω –æ—Ç–≤–µ—Ç–∏—Ç –≤–∞—à–∏–º Chat ID (—á–∏—Å–ª–æ —Ç–∏–ø–∞ `123456789`)

**–°–ø–æ—Å–æ–± 2: –ß–µ—Ä–µ–∑ @getmyid_bot**
1. –ù–∞–π–¥–∏—Ç–µ –±–æ—Ç–∞ `@getmyid_bot`
2. –ù–∞–∂–º–∏—Ç–µ Start
3. –ë–æ—Ç –ø–æ–∫–∞–∂–µ—Ç –≤–∞—à Chat ID

**–°–ø–æ—Å–æ–± 3: –î–ª—è –≥—Ä—É–ø–ø—ã**
1. –î–æ–±–∞–≤—å—Ç–µ –≤–∞—à–µ–≥–æ –±–æ—Ç–∞ –≤ –≥—Ä—É–ø–ø—É
2. –û—Ç–ø—Ä–∞–≤—å—Ç–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –≤ –≥—Ä—É–ø–ø—É
3. –û—Ç–∫—Ä–æ–π—Ç–µ –≤ –±—Ä–∞—É–∑–µ—Ä–µ:
   ```
   https://api.telegram.org/bot<TOKEN>/getUpdates
   ```
4. –ù–∞–π–¥–∏—Ç–µ `"chat":{"id":-1001234567890}` - —ç—Ç–æ Chat ID –≥—Ä—É–ø–ø—ã

### –®–∞–≥ 3: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏

1. **–û—Ç–∫—Ä–æ–π—Ç–µ —Ñ–∞–π–ª** `telegram_bot/config.php`

2. **–í—Å—Ç–∞–≤—å—Ç–µ —Ç–æ–∫–µ–Ω –±–æ—Ç–∞:**
   ```php
   define('TELEGRAM_BOT_TOKEN', '7123456789:AAHxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx');
   ```

3. **–í—Å—Ç–∞–≤—å—Ç–µ Chat ID:**
   ```php
   define('TELEGRAM_CHAT_IDS', '123456789');
   ```
   
   –î–ª—è –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –ø–æ–ª—É—á–∞—Ç–µ–ª–µ–π:
   ```php
   define('TELEGRAM_CHAT_IDS', '123456789,987654321,-1001234567890');
   ```

4. **–£–∫–∞–∂–∏—Ç–µ URL –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞:**
   ```php
   define('MONITOR_URLS', 'https://your-domain.com,https://your-domain.com/dashboard.php');
   ```

### –®–∞–≥ 4: –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

```bash
# –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ –ø–∞–ø–∫—É —Å –±–æ—Ç–æ–º
cd telegram_bot

# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –æ—Ç–ø—Ä–∞–≤–∫—É –≤ Telegram
php monitor.php --test

# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ URL
php monitor.php

# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π URL
php monitor.php --url=https://google.com
```

## ‚è∞ –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Cron

### Linux / Ubuntu / Debian

```bash
# –û—Ç–∫—Ä–æ–π—Ç–µ crontab
crontab -e

# –î–æ–±–∞–≤—å—Ç–µ —Å—Ç—Ä–æ–∫—É (–ø—Ä–æ–≤–µ—Ä–∫–∞ –∫–∞–∂–¥—É—é –º–∏–Ω—É—Ç—É):
* * * * * /usr/bin/php /path/to/telegram_bot/monitor.php >> /dev/null 2>&1

# –ò–ª–∏ —Å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ–º –≤ —Ñ–∞–π–ª:
* * * * * /usr/bin/php /path/to/telegram_bot/monitor.php >> /var/log/monitor.log 2>&1
```

### –ü—Ä–∏–º–µ—Ä—ã —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è cron:

```bash
# –ö–∞–∂–¥—É—é –º–∏–Ω—É—Ç—É
* * * * * /usr/bin/php /path/to/monitor.php

# –ö–∞–∂–¥—ã–µ 5 –º–∏–Ω—É—Ç
*/5 * * * * /usr/bin/php /path/to/monitor.php

# –ö–∞–∂–¥—ã–µ 15 –º–∏–Ω—É—Ç
*/15 * * * * /usr/bin/php /path/to/monitor.php

# –ö–∞–∂–¥—ã–π —á–∞—Å
0 * * * * /usr/bin/php /path/to/monitor.php
```

### Windows (–ü–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫ –∑–∞–¥–∞—á)

1. –û—Ç–∫—Ä–æ–π—Ç–µ "–ü–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫ –∑–∞–¥–∞–Ω–∏–π" (Task Scheduler)
2. –°–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤—É—é –∑–∞–¥–∞—á—É
3. –¢—Ä–∏–≥–≥–µ—Ä: "–ü–æ–≤—Ç–æ—Ä—è—Ç—å –∫–∞–∂–¥—ã–µ 1 –º–∏–Ω—É—Ç—É"
4. –î–µ–π—Å—Ç–≤–∏–µ: –ó–∞–ø—É—Å—Ç–∏—Ç—å –ø—Ä–æ–≥—Ä–∞–º–º—É
   - –ü—Ä–æ–≥—Ä–∞–º–º–∞: `C:\php\php.exe`
   - –ê—Ä–≥—É–º–µ–Ω—Ç—ã: `"C:\path\to\telegram_bot\monitor.php"`

### –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç—ã cron

```bash
# –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –ª–æ–≥–∏ cron (Linux)
grep CRON /var/log/syslog

# –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –ª–æ–≥ –º–æ–Ω–∏—Ç–æ—Ä–∞
tail -f telegram_bot/monitor.log
```

## üöÄ –†–µ–∂–∏–º—ã —Ä–∞–±–æ—Ç—ã

### –û–¥–∏–Ω–æ—á–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ (–¥–ª—è cron)
```bash
php monitor.php
```

### –†–µ–∂–∏–º –¥–µ–º–æ–Ω–∞ (–ø–æ—Å—Ç–æ—è–Ω–Ω–∞—è —Ä–∞–±–æ—Ç–∞)
```bash
php monitor.php --daemon
```

### –° systemd (Linux)

–°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª `/etc/systemd/system/server-monitor.service`:
```ini
[Unit]
Description=Server Monitor Bot
After=network.target

[Service]
Type=simple
User=www-data
WorkingDirectory=/path/to/telegram_bot
ExecStart=/usr/bin/php monitor.php --daemon
Restart=always
RestartSec=10

[Install]
WantedBy=multi-user.target
```

–ó–∞–ø—É—Å—Ç–∏—Ç–µ:
```bash
sudo systemctl daemon-reload
sudo systemctl enable server-monitor
sudo systemctl start server-monitor
```

## ‚öôÔ∏è –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏

| –ü–∞—Ä–∞–º–µ—Ç—Ä | –û–ø–∏—Å–∞–Ω–∏–µ | –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é |
|----------|----------|--------------|
| `TELEGRAM_BOT_TOKEN` | –¢–æ–∫–µ–Ω –±–æ—Ç–∞ –æ—Ç @BotFather | - |
| `TELEGRAM_CHAT_IDS` | Chat ID –ø–æ–ª—É—á–∞—Ç–µ–ª–µ–π (—á–µ—Ä–µ–∑ –∑–∞–ø—è—Ç—É—é) | - |
| `MONITOR_URLS` | URL –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ (—á–µ—Ä–µ–∑ –∑–∞–ø—è—Ç—É—é) | - |
| `REQUEST_TIMEOUT` | –¢–∞–π–º–∞—É—Ç –∑–∞–ø—Ä–æ—Å–∞ –≤ —Å–µ–∫—É–Ω–¥–∞—Ö | 30 |
| `ALLOWED_HTTP_CODES` | –î–æ–ø—É—Å—Ç–∏–º—ã–µ HTTP –∫–æ–¥—ã | 200,301,302,401,403 |
| `CHECK_INTERVAL` | –ò–Ω—Ç–µ—Ä–≤–∞–ª –ø—Ä–æ–≤–µ—Ä–∫–∏ (–¥–ª—è –¥–µ–º–æ–Ω–∞) | 60 |
| `ERROR_THRESHOLD` | –ö–æ–ª-–≤–æ –æ—à–∏–±–æ–∫ –¥–æ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è | 2 |
| `NOTIFY_ON_RECOVERY` | –£–≤–µ–¥–æ–º–ª—è—Ç—å –æ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–∏ | true |
| `DEBUG_MODE` | –ü–æ–¥—Ä–æ–±–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ | false |

## üì± –ü—Ä–∏–º–µ—Ä—ã —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π

### –ü—Ä–∏ –ø–∞–¥–µ–Ω–∏–∏:
```
üî¥ –°–ï–†–í–ï–† –ù–ï–î–û–°–¢–£–ü–ï–ù

üåê URL: https://your-domain.com
‚ùå –û—à–∏–±–∫–∞: HTTP 502 (–æ–∂–∏–¥–∞–ª–æ—Å—å: 200/301/302/401/403)
‚è±Ô∏è –í—Ä–µ–º—è –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏: 2 –º–∏–Ω
üî¢ –ü–æ–ø—ã—Ç–æ–∫: 2
üìÖ –í—Ä–µ–º—è –ø—Ä–æ–≤–µ—Ä–∫–∏: 2024-01-15 12:30:45
üñ•Ô∏è –ú–æ–Ω–∏—Ç–æ—Ä: my-server
```

### –ü—Ä–∏ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–∏:
```
üü¢ –°–ï–†–í–ï–† –í–û–°–°–¢–ê–ù–û–í–õ–ï–ù

üåê URL: https://your-domain.com
‚úÖ –°—Ç–∞—Ç—É—Å: HTTP 200, 245ms
‚è±Ô∏è –ë—ã–ª –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω: 5 –º–∏–Ω
üìÖ –í—Ä–µ–º—è –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è: 2024-01-15 12:35:22
```

## üîß –£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º

### "–°–æ–æ–±—â–µ–Ω–∏–µ –Ω–µ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è"
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ç–æ–∫–µ–Ω –±–æ—Ç–∞
2. –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ –±–æ—Ç –Ω–µ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω
3. –î–ª—è –≥—Ä—É–ø–ø—ã: –¥–æ–±–∞–≤—å—Ç–µ –±–æ—Ç–∞ –≤ –≥—Ä—É–ø–ø—É –∏ –¥–∞–π—Ç–µ –ø—Ä–∞–≤–∞ –Ω–∞ –æ—Ç–ø—Ä–∞–≤–∫—É

### "Chat not found"
1. –û—Ç–ø—Ä–∞–≤—å—Ç–µ –ª—é–±–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –±–æ—Ç—É –ø–µ—Ä–≤—ã–º
2. –î–ª—è –≥—Ä—É–ø–ø—ã: –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ Chat ID —Å –º–∏–Ω—É—Å–æ–º (-100...)

### "Connection refused" –ø—Ä–∏ –ø—Ä–æ–≤–µ—Ä–∫–µ
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ URL –≤ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
2. –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ —Å–µ—Ä–≤–µ—Ä –¥–æ—Å—Ç—É–ø–µ–Ω –∏–∑ –º–µ—Å—Ç–∞ –≥–¥–µ –∑–∞–ø—É—â–µ–Ω –º–æ–Ω–∏—Ç–æ—Ä

### –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç–æ–∫–µ–Ω–∞
```bash
curl "https://api.telegram.org/bot<TOKEN>/getMe"
```
–î–æ–ª–∂–µ–Ω –≤–µ—Ä–Ω—É—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –±–æ—Ç–µ.

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ñ–∞–π–ª–æ–≤

```
telegram_bot/
‚îú‚îÄ‚îÄ config.php          # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
‚îú‚îÄ‚îÄ monitor.php         # –û—Å–Ω–æ–≤–Ω–æ–π —Å–∫—Ä–∏–ø—Ç
‚îú‚îÄ‚îÄ monitor_state.json  # –°–æ—Å—Ç–æ—è–Ω–∏–µ (—Å–æ–∑–¥–∞—ë—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏)
‚îú‚îÄ‚îÄ monitor.log         # –õ–æ–≥ (—Å–æ–∑–¥–∞—ë—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏)
‚îî‚îÄ‚îÄ README.md           # –≠—Ç–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
```

## üîí –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

- –•—Ä–∞–Ω–∏—Ç–µ `config.php` –≤–Ω–µ –ø—É–±–ª–∏—á–Ω–æ–π –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏
- –ù–µ –∫–æ–º–º–∏—Ç—å—Ç–µ —Ç–æ–∫–µ–Ω—ã –≤ git (–¥–æ–±–∞–≤—å—Ç–µ –≤ `.gitignore`)
- –û–≥—Ä–∞–Ω–∏—á—å—Ç–µ –ø—Ä–∞–≤–∞ –Ω–∞ —Ñ–∞–π–ª—ã: `chmod 600 config.php`

## üìù –õ–∏—Ü–µ–Ω–∑–∏—è

MIT License